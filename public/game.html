<!DOCTYPE html>
<html>

<head>
	<title>Virtual Kings</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="/socket.io/socket.io.js"></script>
<script>
var channelID = window.location.pathname.replace(/\/game\//, '');
var socket = io();

// connect to the game channel
// game channel XXXXXXX needs to be replaced with the actual channelID before the server sends the page to client
socket.emit('mailman', '{"method" : "game_play", "payload" : {"channelID" : "'+channelID+'"}}')

socket.on('messages', function(data) {
	var data = JSON.parse(data)
	console.log(data)
	// get method to do with the message
	var method = data.method
  // messages could either be...
  if (method == 'game_play') {
  	document.getElementById('player-count').innerHTML = data.payload.number_players
  	document.getElementById('current-player').innerHTML = data.payload.next_player
  } else if (method == 'card_play') {
  	document.getElementById('current-player').innerHTML = data.payload.next_player
  	document.getElementById('card').innerHTML = data.payload.card
  }
  // update room status (number of players, xyz disconnected)

  // card has been played 

  // enable the player to play a card
})

// send signal that the player just played a card
function sendCardPlay() {
	console.log('card at play')
	socket.emit('mailman', '{"method" : "card_play", "payload" : {"channelID" : "' + channelID + '"}}')
}

document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('roomCode').innerHTML = channelID
}); 

</script>

</head>

<body>
<div class="wrapper">
	<div class="header">
		<div class="room-info">
			<div class="info">Room name: <span id="roomCode"></span> </div>
			<div class="info"><span id="player-count"></span> people in the room</div>
			<div class="info"><span id="current-player"></span> to play </div>
		</div>
	</div>

	<div class="play-area">
		<button onclick='sendCardPlay();'> Play a card </button>
		<div class="main-area">
			<div id="card">
			</div>
		</div>
	</div>

</body>
</html>