<!DOCTYPE html>
<html>
  <head>
    <title>Joined Room</title>
  </head>
  <script src="https://code.jquery.com/jquery-2.2.2.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script>


    function join() {
      var url_string = window.location.href;
      var url = new URL(url_string);
      var username = url.searchParams.get("username");
      var code = document.getElementById("roomCode").value;
      const xhr = new XMLHttpRequest();

      xhr.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          if (this.responseText == 'true') {
            window.location = '/waiting_room?username=' + userName + '&room=' + code
          } else {
            // add a notification that the code is wrong
          }
        }
      }

      xhr.open("POST", "/check_code")
      xhr.setRequestHeader("Content-Type", "application/json");
      xhr.send(JSON.stringify({code:code}));
    }
    

  </script>

  <body>
    <form id="join">
      <label for="roomCode">Enter the five digit room code</label>
      <input id="roomCode" type="text" maxlength="5" class="box" autofocus />
      <input type="button" id="join" value="Join Room" class="btn" />
    </form>
  </body>
</html>